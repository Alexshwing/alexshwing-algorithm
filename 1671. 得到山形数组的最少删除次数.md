```python
class Solution:
    # 300. 最长递增子序列
    def lengthOfLIS(self, A: List[int]) -> List[int]:
        n = len(A)
        dp = [0] * (n + 1)
        sz = 0
        res = [] # 以 i 结尾最长递增子序列长度
        for i, x in enumerate(A):
            l, r = 0, sz
            while l < r:
                mid = (l + r + 1) // 2
                if dp[mid] < x: l = mid
                else: r = mid - 1
            sz = max(sz, r + 1)
            res.append(sz)
            dp[r + 1] = x
        return res

    def minimumMountainRemovals(self, A: List[int]) -> int:
        pre = self.lengthOfLIS(A)
        suf = self.lengthOfLIS(A[::-1])[::-1]

        ans = 0
        for x, y in zip(pre, suf):
            if x > 1 and y > 1:
                ans = max(ans, x + y - 1)
        return len(A) - ans
```