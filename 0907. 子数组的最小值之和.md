```go
func sumSubarrayMins(arr []int) (ans int) {
    n := len(arr)
    l := make([]int, n)
    r := make([]int, n)
    for i := range r {
        r[i] = n
    }
    st := []int{-1}
    for i, x := range arr {
        for len(st) > 1 && arr[st[len(st)-1]] >= x {
            r[st[len(st)-1]] = i
            st = st[:len(st)-1]
        }
        l[i] = st[len(st)-1]
        st = append(st, i)
    }
    for i, x := range arr {
        ans += x * (i - l[i]) * (r[i] - i)
    }
    return ans % (1e9 + 7)
}
```