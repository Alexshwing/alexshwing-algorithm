```python
from sortedcontainers import SortedList
class Magic:
    def __init__(self, K: int):
        self.L = SortedList() # 保存前 k 小值
        self.R = SortedList() # 保存其他值
        self.K = K # 窗口长度
        self.sm = 0 # 前 k 小和

    # 调整 L 和 R 的大小，保证调整后 L 保存前 K 小值
    def adjust(self):
        while len(self.L) < self.K and len(self.R) > 0:
            t = self.R.pop(0)
            self.L.add(t)
            self.sm += t
        while len(self.L) > self.K:
            t = self.L.pop()
            self.R.add(t)
            self.sm -= t

    # 插入元素 x
    def add(self, x: int):
        if len(self.R) and x >= self.R[0]:
            self.R.add(x)
        else:
            self.L.add(x)
            self.sm += x
        self.adjust()

    # 删除元素 x
    def delete(self, x: int):
        if x in self.L:
            self.L.remove(x)
            self.sm -= x
        else:
            self.R.remove(x)
        self.adjust()

class Solution:
    def minimumCost(self, A: List[int], k: int, dist: int) -> int:
        n = len(A)

        # 滑动窗口初始化
        magic = Magic(k - 2)
        for i in range(1, k - 1): magic.add(A[i])

        ans = magic.sm + A[k - 1]
        # 枚举最后一个字母开头
        for i in range(k, n):
            t = i - dist - 1
            if t > 0: magic.delete(A[t])
            magic.add(A[i - 1])
            ans = min(ans, magic.sm + A[i])

        return ans + A[0]
```
